<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>btw • btw</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="btw"><meta property="og:image" content="https://posit-dev.github.io/btw/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">btw</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/posit-dev/btw/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>btw</h1>
      <small class="dont-index">Source: <a href="https://github.com/posit-dev/btw/blob/main/AGENTS.md" class="external-link"><code>AGENTS.md</code></a></small>
    </div>

<div id="btw" class="section level1">

<blockquote>
<p>Bridge R computational environments and Large Language Models</p>
</blockquote>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p>btw is an R package that helps humans and LLMs work together with R by providing utilities to describe R objects, package documentation, and workspace state in LLM-friendly plain text. The package offers a flexible collection of tools that can be used interactively (copy-paste workflows), programmatically (direct function calls), or as enhanced chat clients (via ellmer or MCP servers).</p>
<p>The primary goal is creating a collection of tools useful to both LLMs and humans when working together with R, with an emphasis on flexibility of usage across different workflows and platforms.</p>
</div>
<div class="section level2">
<h2 id="quick-reference">Quick Reference<a class="anchor" aria-label="anchor" href="#quick-reference"></a></h2>
<ul><li>
<strong>Project type:</strong> R Package</li>
<li>
<strong>Language:</strong> R (≥ 4.1.0)</li>
<li>
<strong>Key frameworks:</strong> ellmer (LLM chat integration), mcptools (Model Context Protocol), shiny and shinychat (chat app)</li>
</ul></div>
<div class="section level2">
<h2 id="purpose-and-design-philosophy">Purpose and Design Philosophy<a class="anchor" aria-label="anchor" href="#purpose-and-design-philosophy"></a></h2>
<p>btw prioritizes flexibility of usage through multiple entry points:</p>
<ul><li>
<strong><code><a href="reference/btw.html">btw()</a></code></strong> - Interactive copy-paste workflow: gather context from R and paste into any chat interface</li>
<li>
<strong><code><a href="reference/btw_tools.html">btw_tools()</a></code></strong> - Register tools with ellmer chat clients for custom applications</li>
<li>
<strong><code><a href="reference/btw_client.html">btw_client()</a></code> / <code><a href="reference/btw_client.html">btw_app()</a></code></strong> - Batteries-included chat clients with your preferred LLM provider, model, and project context</li>
<li>
<strong>MCP server</strong> - Expose tools to third-party coding agents like Claude Desktop or Continue via <code><a href="reference/mcp.html">btw_mcp_server()</a></code>
</li>
</ul><p>Project configuration via <code>btw.md</code> files provides conversation stability across sessions by defining default provider, model, tools, and project-specific instructions. These files are treated as instructions for coding assistants and help avoid repeating context.</p>
<p>btw also serves as a laboratory for discovering best practices in LLM tool design - output formats and approaches evolve based on experimentation with what works best across different models.</p>
</div>
<div class="section level2">
<h2 id="key-design-decisions">Key Design Decisions<a class="anchor" aria-label="anchor" href="#key-design-decisions"></a></h2>
<ul><li>
<strong>Multiple entry points for flexibility</strong> - Support interactive, programmatic, and agent-based workflows without forcing users into a single pattern</li>
<li>
<strong>S3 dispatch via <code><a href="reference/btw_this.html">btw_this()</a></code></strong> - Extensible backend for describing different R object types, with <code><a href="reference/btw_this.character.html">btw_this.character()</a></code> handling command aliases for non-object concepts</li>
<li>
<strong>Tool grouping for safety and clarity</strong> - Tools organized into categories (docs, env, files, ide, search, session, web) to reduce LLM cognitive load and provide granular safety controls</li>
<li>
<strong>Project configuration via <code>btw.md</code></strong> - Enables stable, repeatable conversations across sessions with project-specific context and preferred settings</li>
<li>
<strong>S7 interoperability</strong> - Uses S7 classes where required by ellmer’s API while keeping most package code in familiar S3</li>
<li>
<strong>Experimental format optimization</strong> - Continuous testing of output formats (JSON for data, markdown for display, plain text for docs) to find what LLMs handle best</li>
</ul></div>
<div class="section level2">
<h2 id="how-it-works">How It Works<a class="anchor" aria-label="anchor" href="#how-it-works"></a></h2>
<div class="section level3">
<h3 id="core-architecture">Core Architecture<a class="anchor" aria-label="anchor" href="#core-architecture"></a></h3>
<p>The package has three main layers:</p>
<ol style="list-style-type: decimal"><li>
<strong>User-facing API</strong> - <code><a href="reference/btw.html">btw()</a></code> function accepts any R objects, help topics, file paths, or special commands (e.g., <code>"@platform_info"</code>, <code>"{dplyr}"</code>) and assembles them into LLM-ready context</li>
<li>
<strong>Description System</strong> - <code><a href="reference/btw_this.html">btw_this()</a></code> S3 generic dispatches to type-specific methods that know how to describe data frames, functions, environments, packages, etc.</li>
<li>
<strong>Tool System</strong> - ~20 individual tools that can be registered with ellmer chats or MCP servers to give LLMs active capabilities beyond passive context</li>
<li>
<strong>Agents</strong> - <code>btw_task_*()</code> functions provide guided workflows for common tasks and are primarily intended for interactive use, but can also be used as sub-agents via tool calls.</li>
</ol></div>
<div class="section level3">
<h3 id="entry-points">Entry Points<a class="anchor" aria-label="anchor" href="#entry-points"></a></h3>
<p><strong>Interactive Copy-Paste (<code><a href="reference/btw.html">btw()</a></code>)</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/btw.html">btw</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"{dplyr}"</span>, <span class="op">?</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">)</span></span>
<span><span class="co"># ✔ btw copied to the clipboard!</span></span></code></pre></div>
<p>Assembles context and copies to clipboard for pasting into any chat interface.</p>
<p><strong>Programmatic Tool Registration (<code><a href="reference/btw_tools.html">btw_tools()</a></code>)</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/chat_anthropic.html" class="external-link">chat_anthropic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">chat</span><span class="op">$</span><span class="fu">set_tools</span><span class="op">(</span><span class="fu"><a href="reference/btw_tools.html">btw_tools</a></span><span class="op">(</span><span class="st">"docs"</span>, <span class="st">"env"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Only doc and environment tools</span></span></code></pre></div>
<p>Register specific tool groups with ellmer chat clients.</p>
<p><strong>Batteries-Included Chat (<code><a href="reference/btw_client.html">btw_client()</a></code> / <code><a href="reference/btw_client.html">btw_app()</a></code>)</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/btw_client.html">btw_client</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>  <span class="co"># Starts with mtcars in context</span></span>
<span><span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="st">"Summarize this data"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/btw_client.html">btw_app</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Launches Shiny chat interface</span></span></code></pre></div>
<p>Pre-configured chat clients with btw tools, project context from <code>btw.md</code>, and initial objects.</p>
<p><strong>MCP Server (<code><a href="reference/mcp.html">btw_mcp_server()</a></code>)</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/mcp.html">btw_mcp_server</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Blocks; run non-interactively</span></span></code></pre></div>
<p>Exposes btw tools to external MCP clients. Configure in Claude Desktop or other MCP-compatible tools.</p>
</div>
<div class="section level3">
<h3 id="tool-system-design">Tool System Design<a class="anchor" aria-label="anchor" href="#tool-system-design"></a></h3>
<p>Tools are defined in <code>R/tool-*.R</code> files following a consistent pattern:</p>
<ol style="list-style-type: decimal"><li>
<strong>Implementation function</strong> (<code>btw_tool_*_impl()</code>) - Does the actual work, returns a tool result object</li>
<li>
<strong>Exported wrapper</strong> (<code>btw_tool_*()</code>) - Thin wrapper with roxygen docs for users</li>
<li>
<strong>Tool registration</strong> - Called via <code>.btw_add_to_tools()</code> to register with ellmer</li>
</ol><p>Tools are grouped by capability: - <strong>docs</strong> - Package documentation, help pages, vignettes, NEWS - <strong>env</strong> - Describe data frames and environments - <strong>files</strong> - Read, write, list files; search code - <strong>ide</strong> - Read current editor/selection in RStudio/Positron - <strong>search</strong> - Search CRAN packages - <strong>session</strong> - Platform info, installed packages - <strong>web</strong> - Read web pages as markdown</p>
</div>
<div class="section level3">
<h3 id="the-btw_this-dispatch-system">The btw_this() Dispatch System<a class="anchor" aria-label="anchor" href="#the-btw_this-dispatch-system"></a></h3>
<p><code><a href="reference/btw_this.html">btw_this()</a></code> is the extensible backend that powers <code><a href="reference/btw.html">btw()</a></code>:</p>
<ul><li>
<code><a href="reference/btw_this.data.frame.html">btw_this.data.frame()</a></code> - Uses skimr to create JSON summaries</li>
<li>
<code>btw_this.function()</code> - Captures function source code</li>
<li>
<code><a href="reference/btw_this.environment.html">btw_this.environment()</a></code> - Lists and describes objects</li>
<li>
<code><a href="reference/btw_this.character.html">btw_this.character()</a></code> - <strong>Command dispatcher</strong> for special strings:
<ul><li>
<code>"./path"</code> → read file or list directory</li>
<li>
<code>"{pkgName}"</code> or <code>"@pkg pkgName"</code> → package help topics + intro vignette</li>
<li>
<code>"?help_topic"</code> or <code>"@help topic"</code> → help page lookup (supports <code>@help pkg::topic</code> and <code>@help pkg topic</code> formats)</li>
<li>
<code>"@git status|diff|log"</code> → git repository information</li>
<li>
<code>"@issue #number"</code> or <code>"@pr #number"</code> → GitHub issues/PRs with auto-repo detection</li>
<li>
<code>"@platform_info"</code> → session/platform details</li>
<li>
<code>"@current_file"</code> → read active editor</li>
<li>And more (see <code><a href="reference/btw_this.character.html">?btw_this.character</a></code>)</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="project-configuration">Project Configuration<a class="anchor" aria-label="anchor" href="#project-configuration"></a></h3>
<p><code>btw.md</code> or <code>AGENTS.md</code> files provide project-specific context:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="an">client:</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">  provider: claude</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">  model: claude-3-7-sonnet-20250219</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="an">tools:</span><span class="co"> [data, docs, environment]</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>Follow these style rules: ...</span></code></pre></div>
<p>btw looks for these files in: 1. Current working directory or its parents (project-specific) 2. <code>~/.config/btw/btw.md</code> or <code>~/btw.md</code> (global defaults)</p>
<p>Content becomes part of the system prompt. Use <code>&lt;!-- HIDE --&gt;</code> / <code>&lt;!-- /HIDE --&gt;</code> comments to exclude sections from the prompt.</p>
</div>
<div class="section level3">
<h3 id="task-system-emerging-pattern">Task System (Emerging Pattern)<a class="anchor" aria-label="anchor" href="#task-system-emerging-pattern"></a></h3>
<p>The <code>btw_task_*()</code> pattern provides guided workflows:</p>
<ul><li>
<code><a href="reference/btw_task_create_btw_md.html">btw_task_create_btw_md()</a></code> - Interactive assistant for creating a <code>btw.md</code> file in a new project</li>
<li>
<code><a href="reference/btw_task_create_readme.html">btw_task_create_readme()</a></code> - Interactive assistant to help create a README for end users</li>
<li>Future tasks will follow similar patterns for common workflows</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="technical-details">Technical Details<a class="anchor" aria-label="anchor" href="#technical-details"></a></h2>
<div class="section level3">
<h3 id="core-dependencies">Core Dependencies<a class="anchor" aria-label="anchor" href="#core-dependencies"></a></h3>
<ul><li>
<strong>ellmer</strong> (≥ 0.3.0) - LLM chat client framework; provides base <code>Chat</code> class and tool system</li>
<li>
<strong>mcptools</strong> - Model Context Protocol implementation for exposing tools to external agents</li>
<li>
<strong>S7</strong> - Object-oriented system used by ellmer; btw uses it for interoperability</li>
<li>
<strong>skimr</strong> - Data frame summaries with statistical distributions</li>
<li>
<strong>pkgsearch</strong> - Search and retrieve CRAN package information</li>
<li>
<strong>sessioninfo</strong> - Detailed R session information</li>
<li>
<strong>rstudioapi</strong> - IDE integration (works with RStudio and Positron)</li>
</ul></div>
<div class="section level3">
<h3 id="supporting-dependencies">Supporting Dependencies<a class="anchor" aria-label="anchor" href="#supporting-dependencies"></a></h3>
<ul><li>
<strong>cli</strong> - User-facing messages and formatting</li>
<li>
<strong>clipr</strong> - Clipboard operations</li>
<li>
<strong>dplyr</strong> - Data manipulation</li>
<li>
<strong>fs</strong> - File system operations</li>
<li>
<strong>jsonlite</strong> - JSON serialization</li>
<li>
<strong>rmarkdown</strong> - YAML frontmatter parsing and vignette rendering</li>
<li>
<strong>xml2</strong> - HTML/XML parsing for web content</li>
</ul></div>
<div class="section level3">
<h3 id="suggested-tools">Suggested Tools<a class="anchor" aria-label="anchor" href="#suggested-tools"></a></h3>
<ul><li>
<strong>shinychat</strong> (≥ 0.2.0) - Powers <code><a href="reference/btw_client.html">btw_app()</a></code> chat interface</li>
<li>
<strong>chromote</strong> - Headless browser for reading dynamic web pages</li>
<li>
<strong>pandoc</strong> - Document conversion (vignettes, help pages)</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="directory-structure">Directory Structure<a class="anchor" aria-label="anchor" href="#directory-structure"></a></h2>
<pre><code>btw/
├── R/                          # Package source code
│   ├── btw.R                   # Main user-facing btw() function
│   ├── btw_this.R              # S3 generic and default method
│   ├── btw_client.R            # Enhanced chat client creation
│   ├── btw_client_app.R        # Shiny app interface
│   ├── tools.R                 # Tool registration (btw_tools())
│   ├── aaa-tools.R             # Tool registry infrastructure
│   ├── tool-*.R                # Individual tool implementations
│   ├── task_*.R                # Guided workflow tasks (new pattern)
│   ├── mcp.R                   # MCP server integration
│   ├── utils-*.R               # Utility functions
│   └── import-standalone-*.R   # Vendored rlang utilities
│
├── inst/
│   ├── prompts/                # System prompts for LLMs
│   │   ├── btw-init.md         # Project documentation task prompt
│   │   ├── btw-system_session.md
│   │   ├── btw-system_tools.md
│   │   └── btw-system_project.md
│   ├── icons/                  # SVG icons for tool categories
│   └── js/                     # JavaScript utilities
│
├── man/                        # Generated documentation
├── tests/testthat/             # Test suite
│   ├── _snaps/                 # Snapshot tests for tool outputs
│   ├── fixtures/               # Test data
│   ├── helpers-*.R             # Test utilities and mocks
│   └── test-*.R                # Test files
│
├── docs/                       # pkgdown website
├── pkgdown/                    # pkgdown configuration
├── DESCRIPTION                 # Package metadata
├── NAMESPACE                   # Exported functions
└── README.Rmd                  # Source for README.md</code></pre>
</div>
<div class="section level2">
<h2 id="development-workflow">Development Workflow<a class="anchor" aria-label="anchor" href="#development-workflow"></a></h2>
<div class="section level3">
<h3 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a></h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install development version</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"posit-dev/btw"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/posit-dev/btw" class="external-link">btw</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try interactive usage</span></span>
<span><span class="fu"><a href="reference/btw.html">btw</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or start a chat</span></span>
<span><span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/btw_client.html">btw_client</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="st">"What tools do you have access to?"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-tests">Running Tests<a class="anchor" aria-label="anchor" href="#running-tests"></a></h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run all tests</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run specific test file</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test_active_file</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update snapshots when tool output changes (verify changes first!)</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/snapshot_accept.html" class="external-link">snapshot_accept</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="common-tasks">Common Tasks<a class="anchor" aria-label="anchor" href="#common-tasks"></a></h3>
<p><strong>Add a new tool:</strong></p>
<ol style="list-style-type: decimal"><li>Create implementation in <code>R/tool-&lt;category&gt;.R</code>:</li>
</ol><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">btw_tool_example_impl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">arg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implementation</span></span>
<span>  <span class="fu">tool_result</span><span class="op">(</span><span class="va">output</span>, extra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>display <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal"><li>Add thin exported wrapper:</li>
</ol><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @export</span></span>
<span><span class="va">btw_tool_example</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">arg</span>, <span class="va">`_intent`</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal"><li>Register with tool system:</li>
</ol><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">.btw_add_to_tools</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"btw_tool_example"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"category"</span>,</span>
<span>  tool <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/tool.html" class="external-link">tool</a></span><span class="op">(</span></span>
<span>      <span class="va">btw_tool_example_impl</span>,</span>
<span>      name <span class="op">=</span> <span class="st">"btw_tool_example"</span>,</span>
<span>      description <span class="op">=</span> <span class="st">"..."</span>,</span>
<span>      arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>arg <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span><span class="st">"..."</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Add a btw_this() method:</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @export</span></span>
<span><span class="va">btw_this.new_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Describe the object as character vector</span></span>
<span>  <span class="fu">as_btw_capture</span><span class="op">(</span><span class="va">output_lines</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Update system prompts:</strong></p>
<p>Edit files in <code>inst/prompts/</code>. These are assembled in <code><a href="reference/btw_client.html">btw_client()</a></code> based on configuration.</p>
</div>
</div>
<div class="section level2">
<h2 id="code-conventions--standards">Code Conventions &amp; Standards<a class="anchor" aria-label="anchor" href="#code-conventions--standards"></a></h2>
<ul><li>
<strong>Use tidyverse patterns</strong> for data manipulation and consistency</li>
<li>
<strong>S3 for package objects</strong>, S7 only where required by ellmer API</li>
<li>
<strong>Tool functions return <code>tool_result()</code> objects</strong> with value and optional display metadata</li>
<li>
<strong>All tool wrappers accept <code>_intent</code> parameter</strong> (added automatically by <code>wrap_with_intent()</code>)</li>
<li>
<strong>Snapshot tests for tool outputs</strong> to catch formatting changes</li>
<li>
<strong>Use <code>check_*()</code> functions</strong> argument validation, described below</li>
</ul><div class="section level3">
<h3 id="type-check-functions">Type Check Functions<a class="anchor" aria-label="anchor" href="#type-check-functions"></a></h3>
<div class="section level4">
<h4 id="scalars">Scalars<a class="anchor" aria-label="anchor" href="#scalars"></a></h4>
<ul><li>
<code>check_bool()</code> - Validates single TRUE/FALSE value</li>
<li>
<code>check_string()</code> - Validates single string (allows empty by default)</li>
<li>
<code>check_name()</code> - Validates non-empty string for use as name</li>
<li>
<code>check_number_decimal()</code> - Validates single numeric value (allows decimals)</li>
<li>
<code>check_number_whole()</code> - Validates single integer value</li>
<li>
<code>check_symbol()</code> - Validates R symbol/name object</li>
<li>
<code>check_arg()</code> - Validates argument name (symbol)</li>
<li>
<code>check_call()</code> - Validates defused call object</li>
<li>
<code>check_environment()</code> - Validates environment object</li>
<li>
<code>check_function()</code> - Validates function (any type)</li>
<li>
<code>check_closure()</code> - Validates R function (not primitive/builtin)</li>
<li>
<code>check_formula()</code> - Validates formula object</li>
</ul></div>
<div class="section level4">
<h4 id="vectors">Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a></h4>
<ul><li>
<code>check_character()</code> - Validates character vector</li>
<li>
<code>check_logical()</code> - Validates logical vector</li>
<li>
<code>check_data_frame()</code> - Validates data frame</li>
</ul></div>
<div class="section level4">
<h4 id="common-parameters">Common Parameters<a class="anchor" aria-label="anchor" href="#common-parameters"></a></h4>
<ul><li>All functions support <code>allow_null</code> parameter</li>
<li>Most scalars support <code>allow_na</code>
</li>
<li>Number checkers support <code>min</code>/<code>max</code> bounds and <code>allow_infinite</code>
</li>
<li>All use <code>arg</code>/<code>call</code> for error context</li>
</ul></div>
</div>
</div>
<div class="section level2">
<h2 id="important-notes">Important Notes<a class="anchor" aria-label="anchor" href="#important-notes"></a></h2>
<ul><li>
<strong>Experimental package</strong> - APIs may change as best practices for LLM tools evolve</li>
<li>
<strong>Tool output formats are fluid</strong> - btw intentionally experiments with different formats (JSON, markdown, plain text) to discover what works best with different models</li>
<li>
<strong>clipboard operations may fail</strong> in non-interactive contexts or without clipboard support</li>
<li>
<strong>IDE tools</strong> (e.g., <code>@current_file</code>) require RStudio or Positron with rstudioapi support</li>
<li>
<strong>Git and GitHub commands</strong> - <code>@git</code> and <code>@issue</code>/<code>@pr</code> commands require gert and gh packages respectively, plus appropriate repository access</li>
<li>
<strong>MCP server blocks</strong> the R process - run non-interactively</li>
<li>
<strong>Test snapshots require frequent updates</strong> as output formatting evolves</li>
</ul></div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a></h2>
<ul><li>
<strong>GitHub:</strong> <a href="https://github.com/posit-dev/btw" class="external-link uri">https://github.com/posit-dev/btw</a>
</li>
<li>
<strong>Website:</strong> <a href="https://posit-dev.github.io/btw/" class="uri">https://posit-dev.github.io/btw/</a>
</li>
<li>
<strong>ellmer package:</strong> <a href="https://github.com/tidyverse/ellmer" class="external-link uri">https://github.com/tidyverse/ellmer</a>
</li>
<li>
<strong>mcptools package:</strong> <a href="https://github.com/posit-dev/mcptools/" class="external-link uri">https://github.com/posit-dev/mcptools/</a>
</li>
<li>
<strong>AGENTS.md spec:</strong> <a href="https://agents.md/" class="external-link uri">https://agents.md/</a>
</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://garrickadenbuie.com" class="external-link">Garrick Aden-Buie</a>, <a href="https://www.simonpcouch.com/" class="external-link">Simon Couch</a>, Joe Cheng, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

